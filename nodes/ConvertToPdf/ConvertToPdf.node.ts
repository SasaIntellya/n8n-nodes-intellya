
import { IBinaryData, IExecuteFunctions, INodeExecutionData, INodeType, INodeTypeDescription } from 'n8n-workflow';
import { exec } from "child_process";
import * as fs from "fs/promises";
import { promisify } from "util";
import * as path from "path";

export class ConvertToPdf implements INodeType {
    description: INodeTypeDescription = {
        displayName: 'ConvertToPdf',
        name: 'ConvertToPdf',
        // icon: 'file:doctopdf.svg',
        icon: `data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjIyNSIgaGVpZ2h0PSIyMjUiPgo8cGF0aCBkPSJNMCAwIEM3NC4yNSAwIDE0OC41IDAgMjI1IDAgQzIyNSA3NC4yNSAyMjUgMTQ4LjUgMjI1IDIyNSBDMTUwLjc1IDIyNSA3Ni41IDIyNSAwIDIyNSBDMCAxNTAuNzUgMCA3Ni41IDAgMCBaICIgZmlsbD0iIzQzN0JDMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwwKSIvPgo8cGF0aCBkPSJNMCAwIEMwLjk0ODc1IDAuMjY4MTI1IDEuODk3NSAwLjUzNjI1IDIuODc1IDAuODEyNSBDNC4zNzQ4MzA4NSAzLjgxMjE2MTcgNC4xMTQwMjA1NSA2LjkzMTk2OTYxIDQuMTkxNDA2MjUgMTAuMjI2NTYyNSBDNC4yMTIxODczNSAxMC45NTYyMDIwOSA0LjIzMjk2ODQ0IDExLjY4NTg0MTY3IDQuMjU0Mzc5MjcgMTIuNDM3NTkxNTUgQzQuMzE5ODE5MTcgMTQuNzcwNzk3NjMgNC4zNzg3MzM2OCAxNy4xMDQxMTcyMSA0LjQzNzUgMTkuNDM3NSBDNC40ODA2OTA1MyAyMS4wMTgyNDA5NSA0LjUyNDMwNDk5IDIyLjU5ODk3MDM5IDQuNTY4MzU5MzggMjQuMTc5Njg3NSBDNC42NzU0OTQ4MSAyOC4wNTcxNzUwNCA0Ljc3Njc3NzgyIDMxLjkzNDc3Njg1IDQuODc1IDM1LjgxMjUgQzUuNTI3MjY1NjIgMzUuMjM1IDYuMTc5NTMxMjUgMzQuNjU3NSA2Ljg1MTU2MjUgMzQuMDYyNSBDNy43MjU1NDY4OCAzMy4zMiA4LjU5OTUzMTI1IDMyLjU3NzUgOS41IDMxLjgxMjUgQzEwLjM1ODUxNTYyIDMxLjA3IDExLjIxNzAzMTI1IDMwLjMyNzUgMTIuMTAxNTYyNSAyOS41NjI1IEMxNS4zNTQwNTA4NCAyNy41MTAyMjU2NyAxNy4wOTcxMjg0NiAyNy4zMDQ1NTA4OSAyMC44NzUgMjcuODEyNSBDMjEuODY1IDI4LjgwMjUgMjEuODY1IDI4LjgwMjUgMjIuODc1IDI5LjgxMjUgQzIxLjg3NSAzNC44MTI1IDIxLjg3NSAzNC44MTI1IDUuODc1IDQ3LjgxMjUgQzMyLjYwNSA0OC4xNDI1IDU5LjMzNSA0OC40NzI1IDg2Ljg3NSA0OC44MTI1IEM4Ni44NzUgNzAuNTkyNSA4Ni44NzUgOTIuMzcyNSA4Ni44NzUgMTE0LjgxMjUgQzI4Ljc5NSAxMTQuODEyNSAtMjkuMjg1IDExNC44MTI1IC04OS4xMjUgMTE0LjgxMjUgQy04OS4xMjUgOTMuMDMyNSAtODkuMTI1IDcxLjI1MjUgLTg5LjEyNSA0OC44MTI1IEMtNDkuMDMgNDguMzE3NSAtNDkuMDMgNDguMzE3NSAtOC4xMjUgNDcuODEyNSBDLTEzLjQwNSA0My41MjI1IC0xOC42ODUgMzkuMjMyNSAtMjQuMTI1IDM0LjgxMjUgQy0yNS4xMjUgMzMuODEyNSAtMjUuMTI1IDMzLjgxMjUgLTI1LjE4NzUgMzEuMjUgQy0yNS4xNjY4NzUgMzAuNDQ1NjI
1IC0yNS4xNDYyNSAyOS42NDEyNSAtMjUuMTI1IDI4LjgxMjUgQy0yMi4wODg2NzI4MyAyNy4yOTQzMzY0MiAtMjAuNTM1NTI2MDEgMjcuMzE2NDIzNDkgLTE3LjEyNSAyNy44MTI1IEMtMTMuODYxMjYxNCAyOS44NDYzNDY4OSAtMTAuODcwMjI5OTkgMzIuMTE2MDc0MSAtOC4xMjUgMzQuODEyNSBDLTguMTI1IDM1LjQ3MjUgLTguMTI1IDM2LjEzMjUgLTguMTI1IDM2LjgxMjUgQy03LjQ2NSAzNi44MTI1IC02LjgwNSAzNi44MTI1IC02LjEyNSAzNi44MTI1IEMtNi4xNDA3MTA0NSAzNS43OTgyNDk1MSAtNi4xNTY0MjA5IDM0Ljc4Mzk5OTAyIC02LjE3MjYwNzQyIDMzLjczOTAxMzY3IEMtNi4yMjY5MDMxOSAyOS45NzYzOTkxMyAtNi4yNjEzNDg1MSAyNi4yMTM4MTkyMiAtNi4yODk3OTQ5MiAyMi40NTA5Mjc3MyBDLTYuMzA0ODgyNDMgMjAuODIyMjg3NzcgLTYuMzI1MzU1MDYgMTkuMTkzNjg4NDQgLTYuMzUxMzE4MzYgMTcuNTY1MTg1NTUgQy02LjM4NzcwNDQ5IDE1LjIyNDM0NDY1IC02LjQwNDcyNjIgMTIuODg0MDQwODEgLTYuNDE3OTY4NzUgMTAuNTQyOTY4NzUgQy02LjQzMzQ1MjYxIDkuODE0NzQ0MTEgLTYuNDQ4OTM2NDYgOS4wODY1MTk0NyAtNi40NjQ4ODk1MyA4LjMzNjIyNzQyIEMtNi40NjU4NzI1NSA1LjM4NDEwODQ5IC02LjQ2MDc5NTY0IDMuMzE4ODI3MDQgLTQuODAyMDAxOTUgMC44MTc2MjY5NSBDLTMuMTI1IC0wLjE4NzUgLTMuMTI1IC0wLjE4NzUgMCAwIFogIiBmaWxsPSIjRTEwMjAyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMTYuMTI1LDkxLjE4NzUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzU4LjQxIDAgMTE2LjgyIDAgMTc3IDAgQzE3NyAyMS43OCAxNzcgNDMuNTYgMTc3IDY2IEMxNDkuMjggNjYgMTIxLjU2IDY2IDkzIDY2IEM5Mi42NyA2NC42OCA5Mi4zNCA2My4zNiA5MiA2MiBDODkuMTI1ODY4NzUgNjEuNjY2MDIyMTMgODkuMTI1ODY4NzUgNjEuNjY2MDIyMTMgODYgNjIgQzg1LjYwMzQyNjk3IDYyLjY1NTc5MDQxIDg1LjIwNjg1Mzk0IDYzLjMxMTU4MDgxIDg0Ljc5ODI2MzU1IDYzLjk4NzI0MzY1IEM4MyA2NiA4MyA2NiA3OS40ODgyMzU0NyA2Ni40ODEwMTgwNyBDNzguMDA1NjAyOTkgNjYuNDkyNjIzMDUgNzYuNTIyNjk5NDEgNjYuNDgxOTU3NCA3NS4wNDAyODMyIDY2LjQ1NDEwMTU2IEM3NC4yMzAyOTg3NyA2Ni40NTQ2ODU2NyA3My40MjAzMTQzMyA2Ni40NTUyNjk3OCA3Mi41ODU3ODQ5MSA2Ni40NTU4NzE1OCBDNjkuOTA3MDE1MjMgNjYuNDUzMDgzNTkgNjcuMjI5MzU2NjYgNjYuNDIxOTU4NzYgNjQuNTUwNzgxMjUgNjYuMzkwNjI1IEM2Mi42OTQxOTQ2MiA2Ni4zODMxNjUxMyA2MC44Mzc2MDAxMiA2Ni4zNzc0NzEgNTguOTgxMDAyODEgNjYuMzczNDc0MTIgQzU0LjA5MzIzNDA1IDY2LjM1ODE5Nzc0IDQ5LjIwNTk0MDM2IDY2LjMxODg5ODcyIDQ0LjMxODM1OTM4IDY2LjI3NDY1ODIgQzM4LjQ1NDczODA0IDY2LjIyNjU1NjcgMzIuNTkwOTU3ODkgNjYuMjA4MTgxMDMgMjYuNzI3MTk1NzQgNjYuMTg0ODQ0OTcgQzE3LjgxNzgwMDAzIDY2LjE0NjA0ODg1IDguOTA5NDQ2OCA2Ni4wNjk0MDkyNCAwI
DY2IEMwIDQ0LjIyIDAgMjIuNDQgMCAwIFogIiBmaWxsPSIjMDQ2NzlEIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNywzMCkiLz4KPHBhdGggZD0iTTAgMCBDMjEuNDYxNTM4NDYgMCAyMS40NjE1Mzg0NiAwIDI3Ljg3NSA1LjQzNzUgQzMxLjk0Njc4MzYgMTAuMzQ3NTkxOTkgMzIuNDQyMTI1MDYgMTQuMDE0MjcyMTggMzIuMzE2NDA2MjUgMjAuMzA4NTkzNzUgQzMxLjcxOTc3MDIxIDI1LjM4MzY4MzAyIDI5LjA5ODIwMTY0IDI4LjAwODkzOTk4IDI1LjQzNzUgMzEuMzEyNSBDMjEuOTg4MzA0NDQgMzMuNzAwNDA0NjIgMTkuNDIxMjg2OTUgMzQuMTIzNzAyNDYgMTUuMzMyMDMxMjUgMzQuMDk3NjU2MjUgQzE0LjUyNzQxNDU1IDM0LjA5NTE1ODY5IDEzLjcyMjc5Nzg1IDM0LjA5MjY2MTEzIDEyLjg5Mzc5ODgzIDM0LjA5MDA4Nzg5IEMxMS4zNjg1NTU5MSAzNC4wNzY0MzE4OCAxMS4zNjg1NTU5MSAzNC4wNzY0MzE4OCA5LjgxMjUgMzQuMDYyNSBDNC45NTUzMTI1IDM0LjAzMTU2MjUgNC45NTUzMTI1IDM0LjAzMTU2MjUgMCAzNCBDMCAyMi43OCAwIDExLjU2IDAgMCBaICIgZmlsbD0iI0ZERjdGNyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTA0LDE1NSkiLz4KPHBhdGggZD0iTTAgMCBDMS40MjMxMjUgMC40MDIxODc1IDEuNDIzMTI1IDAuNDAyMTg3NSAyLjg3NSAwLjgxMjUgQzQuMzc0ODMwODUgMy44MTIxNjE3IDQuMTE0MDIwNTUgNi45MzE5Njk2MSA0LjE5MTQwNjI1IDEwLjIyNjU2MjUgQzQuMjEyMTg3MzUgMTAuOTU2MjAyMDkgNC4yMzI5Njg0NCAxMS42ODU4NDE2NyA0LjI1NDM3OTI3IDEyLjQzNzU5MTU1IEM0LjMxOTgxOTE3IDE0Ljc3MDc5NzYzIDQuMzc4NzMzNjggMTcuMTA0MTE3MjEgNC40Mzc1IDE5LjQzNzUgQzQuNDgwNjkwNTMgMjEuMDE4MjQwOTUgNC41MjQzMDQ5OSAyMi41OTg5NzAzOSA0LjU2ODM1OTM4IDI0LjE3OTY4NzUgQzQuNjc1NDk0ODEgMjguMDU3MTc1MDQgNC43NzY3Nzc4MiAzMS45MzQ3NzY4NSA0Ljg3NSAzNS44MTI1IEM1LjUyNzI2NTYyIDM1LjIzNSA2LjE3OTUzMTI1IDM0LjY1NzUgNi44NTE1NjI1IDM0LjA2MjUgQzcuNzI1NTQ2ODcgMzMuMzIgOC41OTk1MzEyNSAzMi41Nzc1IDkuNSAzMS44MTI1IEMxMC4zNTg1MTU2MiAzMS4wNyAxMS4yMTcwMzEyNSAzMC4zMjc1IDEyLjEwMTU2MjUgMjkuNTYyNSBDMTUuMzU0MDUwODQgMjcuNTEwMjI1NjcgMTcuMDk3MTI4NDYgMjcuMzA0NTUwODkgMjAuODc1IDI3LjgxMjUgQzIxLjUzNSAyOC40NzI1IDIyLjE5NSAyOS4xMzI1IDIyLjg3NSAyOS44MTI1IEMyMi42OTYyNTM1OSAzMi44MjAzODEwNiAyMi4yNjg3MDk2OCAzNC4zNzE2ODkzNiAyMC4yNDg1MzUxNiAzNi42MzM1NDQ5MiBDMTkuNTYwNjU5MTggMzcuMTgxMTU0NzkgMTguODcyNzgzMiAzNy43Mjg3NjQ2NSAxOC4xNjQwNjI1IDM4LjI5Mjk2ODc1IEMxNy4wMzg3MTA5NCAzOS4yMDI3Mj
Q2MSAxNy4wMzg3MTA5NCAzOS4yMDI3MjQ2MSAxNS44OTA2MjUgNDAuMTMwODU5MzggQzE1LjEwMTcxODc1IDQwLjc0NzY3NTc4IDE0LjMxMjgxMjUgNDEuMzY0NDkyMTkgMTMuNSA0MiBDMTIuNzE4ODI4MTMgNDIuNjI4NDE3OTcgMTEuOTM3NjU2MjUgNDMuMjU2ODM1OTQgMTEuMTMyODEyNSA0My45MDQyOTY4OCBDMi41MDkwMTA0MSA1MC44MDc3Njg1OCAyLjUwOTAxMDQxIDUwLjgwNzc2ODU4IC0xLjI2NTYyNSA1MC44MzU5Mzc1IEMtNi40NTI3MTIxMSA0OS40NjA0MTQ0IC05Ljc1MTM0NzU2IDQ2Ljc3NjcyMjkyIC0xMy44NzUgNDMuNDM3NSBDLTE0LjYyOTEwMTU2IDQyLjg0NzEwOTM4IC0xNS4zODMyMDMxMiA0Mi4yNTY3MTg3NSAtMTYuMTYwMTU2MjUgNDEuNjQ4NDM3NSBDLTIzLjAzMzkwOTY1IDM2LjIyNzU3MzM2IC0yMy4wMzM5MDk2NSAzNi4yMjc1NzMzNiAtMjUuMTI1IDMzLjgxMjUgQy0yNS4zMTI1IDMxLjEyNSAtMjUuMzEyNSAzMS4xMjUgLTI1LjEyNSAyOC44MTI1IEMtMjIuMDg4NjcyODMgMjcuMjk0MzM2NDIgLTIwLjUzNTUyNjAxIDI3LjMxNjQyMzQ5IC0xNy4xMjUgMjcuODEyNSBDLTEzLjg2MTI2MTQgMjkuODQ2MzQ2ODkgLTEwLjg3MDIyOTk5IDMyLjExNjA3NDEgLTguMTI1IDM0LjgxMjUgQy04LjEyNSAzNS40NzI1IC04LjEyNSAzNi4xMzI1IC04LjEyNSAzNi44MTI1IEMtNy40NjUgMzYuODEyNSAtNi44MDUgMzYuODEyNSAtNi4xMjUgMzYuODEyNSBDLTYuMTQwNzEwNDUgMzUuNzk4MjQ5NTEgLTYuMTU2NDIwOSAzNC43ODM5OTkwMiAtNi4xNzI2MDc0MiAzMy43MzkwMTM2NyBDLTYuMjI2OTAzMTkgMjkuOTc2Mzk5MTMgLTYuMjYxMzQ4NTEgMjYuMjEzODE5MjIgLTYuMjg5Nzk0OTIgMjIuNDUwOTI3NzMgQy02LjMwNDg4MjQzIDIwLjgyMjI4Nzc3IC02LjMyNTM1NTA2IDE5LjE5MzY4ODQ0IC02LjM1MTMxODM2IDE3LjU2NTE4NTU1IEMtNi4zODc3MDQ0OSAxNS4yMjQzNDQ2NSAtNi40MDQ3MjYyIDEyLjg4NDA0MDgxIC02LjQxNzk2ODc1IDEwLjU0Mjk2ODc1IEMtNi40MzM0NTI2MSA5LjgxNDc0NDExIC02LjQ0ODkzNjQ2IDkuMDg2NTE5NDcgLTYuNDY0ODg5NTMgOC4zMzYyMjc0MiBDLTYuNDY1ODcyNTUgNS4zODQxMDg0OSAtNi40NjA3OTU2NCAzLjMxODgyNzA0IC00LjgwMjAwMTk1IDAuODE3NjI2OTUgQy0zLjEyNSAtMC4xODc1IC0zLjEyNSAtMC4xODc1IDAgMCBaICIgZmlsbD0iIzk0QzkwOCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTE2LjEyNSw5MS4xODc1KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjAxMTI1IC0wLjA2MTg3NSA2LjAyMjUgLTAuMTIzNzUgOS4xMjUgLTAuMTg3NSBDMTAuMDYyMzA5NTcgLTAuMjE0ODEyMDEgMTAuOTk5NjE5MTQgLTAuMjQyMTI0MDIgMTEuOTY1MzMyMDMgLTAuMjcwMjYzNjcgQzE3Ljk3MTYzOTgyIC0wLjMyOTc1MTA3IDIyLjE5MzkzMzA4IDAuNTY4MDc1MzQgMjYuODc1IDQuNjI1IEMyOC42NTA1Mjg0NiA4LjM3MzMzNzg1IDI4LjY1MzIwMTgxIDExLjkzNTYzMzIgMjggMTYgQzI2LjI1OTQ5MzM2IDE5LjAyOTc3MDgxIDI0LjgyMjk1NjIzIDIwLjQ5MTcwMzUgMjEuODc1IDIyLjMxMjUgQzE3LjU0NjEwNzY3IDIzLjM0NzY2OTkxIDEzLjQ0NTMzMzExIDIzLjExODU0MjIyIDkgMjMgQzkgMjYuNjMgOSAzMC4yNiA5IDM0IEM2LjAzIDM0IDMuMDYgMzQgMCAzNCBDMCAyMi43OCAwIDExLjU2IDAgMCBaICIgZmlsbD0iI0ZERjJGMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzAsMTU1KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjU2MjUgMS4wNjI1IDMuNTYyNSAxLjA2MjUgNS45Mzc1IDMuODEyNSBDOS41MDY5ODIwNiAxMC45NTE0NjQxMiA5LjkxNzg4NTg2IDIwLjEzMjU0NzI3IDcuODA4NTkzNzUgMjcuODA0Njg3NSBDNi4xOTAzMTgxOSAzMS42NzU4NTY1IDQuNjA1OTI5NDcgMzUuMzQ3MTA1NjggMC41NjI1IDM3LjA2MjUgQy0xLjkzNzUgMzcuMTI1IC0xLjkzNzUgMzcuMTI1IC00LjQzNzUgMzYuMDYyNSBDLTkuMTIzMjkwODkgMzAuMDc1MTAwNTMgLTkuNjQxMDEwNDUgMjUuNTE5ODAzNDQgLTkuNjg3NSAxOC4yNSBDLTkuNzA4MTI1IDE3LjQ1NTI5Mjk3IC05LjcyODc1IDE2LjY2MDU4NTk0IC05Ljc1IDE1Ljg0MTc5Njg4IEMtOS43ODkyOTA0NCA5LjkwNDAyODM4IC04LjQzMDI2NjExIDYuMTUxMjg3NDcgLTUuMTg3NSAxLjEyNSBDLTMuNDM3NSAwLjA2MjUgLTMuNDM3NSAwLjA2MjUgMCAwIFogIiBmaWxsPSIjRjNGN0ZBIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNDMuNDM3NSw0My45Mzc1KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjE4NzUgMC41IDMuMTg3NSAwLjUgNiAzLjMxMjUgQzkuMzc3OTE1NjUgOC4yMzQ2MDU2NiA5LjQyOTc4NTU4IDEyLjM5NzE1MDQ5IDkuNSAxOC4xODc1IEM5LjUyOTAwMzkxIDE4Ljk2NTQ0OTIyIDkuNTU4MDA3ODEgMTkuNzQzMzk4NDQgOS41ODc4OTA2MiAyMC41NDQ5MjE4OCBDOS42NDk4ODMwOSAyNi4yNjI1MzQ5NyA4LjU1NDEzMzY0IDMwLjc5MjExMjAzIDUuMTg3NSAzNS41IEMyLjE4NzUgMzcuNS
AyLjE4NzUgMzcuNSAtMC4yNSAzNy40Mzc1IEMtMy43MDU3NDM1OCAzNi4xNzMyMDM1NyAtNC44MzE5OTEyOSAzNC41NzMyMDMxNyAtNi44MTI1IDMxLjUgQy05LjY2NTY2Mzc0IDI0LjMwMDYxOTA5IC0xMC4xNjQyMzI2OSAxNi4xMzU0MjI5NyAtNy45ODQzNzUgOC42NjAxNTYyNSBDLTQuNTc2MTE2NzYgMC44MTM1MzE4NyAtNC41NzYxMTY3NiAwLjgxMzUzMTg3IDAgMCBaICIgZmlsbD0iI0YzRjdGQSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzAuODEyNSw0My41KSIvPgo8cGF0aCBkPSJNMCAwIEMxMSAwIDExIDAgMTMuNTYyNSAxLjYyNSBDMTcuNzg4OTAzMTQgOC42MDc3NTMwMiAxNy43MzQ4MzgyNiAxNi4wNzYxNDE2NyAxNyAyNCBDMTUuNjI2MTg0NTMgMjguOTIwMDE4OTUgMTQuMjk2NjYyNjggMzIuMTM1NTU4MjEgMTAgMzUgQzYuNyAzNSAzLjQgMzUgMCAzNSBDMCAyMy40NSAwIDExLjkgMCAwIFogIiBmaWxsPSIjRjdGQUZDIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMTUsNDUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzExIDAgMTEgMCAxNC4xODc1IDIuOTM3NSBDMTcuNDgzMjA1NjMgOS42MjQ3ODYzNCAxNy41NDU1MjYzMiAxOS44Nzk4MTI3NCAxNS40MDIzNDM3NSAyNi45Nzk5ODA0NyBDMTQuMDIxNTA4MjMgMzAuNDIyMTI4NyAxMi42NTkzNTQxOCAzMi4zNDA2NDU4MiAxMCAzNSBDNi43IDM1IDMuNCAzNSAwIDM1IEMwIDIzLjQ1IDAgMTEuOSAwIDAgWiAiIGZpbGw9IiNGOUZCRkMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ0LDQ1KSIvPgo8cGF0aCBkPSJNMCAwIEM3LjkyIDAgMTUuODQgMCAyNCAwIEMyNCAyLjMxIDI0IDQuNjIgMjQgNyBDMTkuMDUgNyAxNC4xIDcgOSA3IEM5IDkuMzEgOSAxMS42MiA5IDE0IEMxMy42MiAxNCAxOC4yNCAxNCAyMyAxNCBDMjMgMTUuOTggMjMgMTcuOTYgMjMgMjAgQzE4LjM4IDIwIDEzLjc2IDIwIDkgMjAgQzkgMjQuNjIgOSAyOS4yNCA5IDM0IEM2LjAzIDM0IDMuMDYgMzQgMCAzNCBDMCAyMi43OCAwIDExLjU2IDAgMCBaICIgZmlsbD0iI0ZERjJGMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTQyLDE1NSkiLz4KPHBhdGggZD0iTTAgMCBDMTMuMiAwIDI2LjQgMCA0MCAwIEMzNi44NzAzNzI4MSAxLjU2NDgxMzU5IDM0LjYxMTA3NTYxIDIuNDIxMzcyMzEgMzE
uMzEyNSAzLjI1IEMyMC4zMTUxMjU4NyA2LjQ2MTYyMjUzIDEyLjAzNDYxNDA1IDE0LjQ2NzI5OTIzIDYgMjQgQzMuNDgwMjEzNiAyOS4xNTkxODI5MiAxLjYwNDU0ODIzIDM0LjI1Njc5MTgxIDEgNDAgQzAuNjcgNDAgMC4zNCA0MCAwIDQwIEMwIDI2LjggMCAxMy42IDAgMCBaICIgZmlsbD0iI0ZDRkRGRSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwwKSIvPgo8cGF0aCBkPSJNMCAwIEMwLjMzIDAgMC42NiAwIDEgMCBDMSAxMi44NyAxIDI1Ljc0IDEgMzkgQy0xMS44NyAzOSAtMjQuNzQgMzkgLTM4IDM5IEMtMzggMzguNjcgLTM4IDM4LjM0IC0zOCAzOCBDLTM2LjkyNzUgMzcuNzkzNzUgLTM1Ljg1NSAzNy41ODc1IC0zNC43NSAzNy4zNzUgQy0yMy4xNzI4MjcyMSAzNC40Mzk2NTMgLTEzLjAwNjk2NzQ3IDI4LjE5NzY3MzY2IC02LjY4NzUgMTggQy0zLjQxNjg3MDk3IDEyLjEzNDE5Nzk0IC0wLjgyMzkxMjYxIDYuNzU2MDgzMzggMCAwIFogIiBmaWxsPSIjRkNGREZFIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMjQsMTg2KSIvPgo8cGF0aCBkPSJNMCAwIEMwLjMzIDAgMC42NiAwIDEgMCBDMS4yMDYyNSAxLjA3MjUgMS40MTI1IDIuMTQ1IDEuNjI1IDMuMjUgQzQuNTYwMzQ3IDE0LjgyNzE3Mjc5IDEwLjgwMjMyNjM0IDI0Ljk5MzAzMjUzIDIxIDMxLjMxMjUgQzI2Ljg2NTgwMjA2IDM0LjU4MzEyOTAzIDMyLjI0MzkxNjYyIDM3LjE3NjA4NzM5IDM5IDM4IEMzOSAzOC4zMyAzOSAzOC42NiAzOSAzOSBDMjYuMTMgMzkgMTMuMjYgMzkgMCAzOSBDMCAyNi4xMyAwIDEzLjI2IDAgMCBaICIgZmlsbD0iI0ZDRkRGRSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwxODYpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEyLjg3IDAgMjUuNzQgMCAzOSAwIEMzOSAxMi44NyAzOSAyNS43NCAzOSAzOSBDMzguNjcgMzkgMzguMzQgMzkgMzggMzkgQzM3Ljc5Mzc1IDM3Ljc0MTg3NSAzNy41ODc1IDM2LjQ4Mzc1IDM3LjM3NSAzNS4xODc1IEMzNS4xMTE4MTQ3MiAyNS4xMjE4NjQ3OCAyOS4wMzM1MDI3NSAxNS4yODE4NDA2NiAyMC41NzgxMjUgOS4yODEyNSBDMTQuMDQ1MjE0MDcgNS4yNDI3MjMyNSA3LjcxMDk4MDU5IDEuOTQwMzYzNDkgMCAxIEMwIDAuNjcgMCAwLjM0IDAgMCBaICIgZmlsbD0iI0ZDRkRGRSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTg2LDApIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuMzEgMCA0LjYyIDAgNyAwIEM3LjY2IDEuOTggOC4zMiAzLjk2IDkgNiBDOS45OSA0LjAyIDEwLjk4IDIuMDQgMTIgMCBDMTMuNjUgMCAxNS4zIDAgMTcgMCBDMTYuNzk1MDM5MDYgMC43MTI4NTE1NiAxNi41OTAwNzgxMiAxLjQyNTcwMzEyIDE2LjM3ODkwNjI1IDIuMTYwMTU2MjUgQzE2LjEwOTQ5MjE5IDMuMTE3OTI5NjkgMTUuODQwMDc4MTIgNC4wNzU3MDMxMyAxNS41NjI1IDUuMDYyNSBDMTUuMjk1NjY0MDYgNi4wMDIyMjY1NiA
xNS4wMjg4MjgxMiA2Ljk0MTk1MzEyIDE0Ljc1MzkwNjI1IDcuOTEwMTU2MjUgQzEzLjEwODU1OTY4IDE0LjY1MzUxOTY0IDEyLjgyMjc2OTI1IDE4LjcwMjU0NDEzIDE1LjQzNzUgMjUuMjUgQzE4IDMxLjc1NzQ5MzE5IDE4IDMxLjc1NzQ5MzE5IDE4IDM1IEMxNS42OSAzNSAxMy4zOCAzNSAxMSAzNSBDMTAuMDEgMzEuNyA5LjAyIDI4LjQgOCAyNSBDNy4wMSAyOC4zIDYuMDIgMzEuNiA1IDM1IEMzLjAyIDM1IDEuMDQgMzUgLTEgMzUgQy0wLjU0Mjg3NzYyIDMzLjQ1Nzk3Mzg0IC0wLjA4NDIzNjUzIDMxLjkxNjM5Nzg2IDAuMzc1IDMwLjM3NSBDMC42NDU3MDMxMyAyOS40NTcxODc1IDAuOTE2NDA2MjUgMjguNTM5Mzc1IDEuMTk1MzEyNSAyNy41OTM3NSBDMiAyNSAyIDI1IDMuMjUgMjEuODc1IEM1LjEzNTU3NjI5IDE0LjY0Njk1NzU2IDIuMDMwNTU0NzcgNi45NDczMDY4NyAwIDAgWiAiIGZpbGw9IiNGM0Y3RkEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3MSw0NSkiLz4KPHBhdGggZD0iTTAgMCBDMy40MzAxNDgwOSA0LjUzNjY0NzQ3IDMuMjgxNDM4MzUgOC41NTg4NTg1OCAzIDE0IEMxLjM1IDE0IC0wLjMgMTQgLTIgMTQgQy0yLjY2IDEyLjAyIC0zLjMyIDEwLjA0IC00IDggQy00Ljk5IDguNDk1IC00Ljk5IDguNDk1IC02IDkgQy02IDE0Ljk0IC02IDIwLjg4IC02IDI3IEMtNS4wMSAyNi42NyAtNC4wMiAyNi4zNCAtMyAyNiBDLTIuMjY2NzYyMDQgMjMuOTg0OTE2NDIgLTIuMjY2NzYyMDQgMjMuOTg0OTE2NDIgLTIgMjIgQy0wLjM1IDIyIDEuMyAyMiAzIDIyIEMyLjg4MzY2NTU0IDI2Ljg1NDMxOTY0IDIuNjQ2MDk5OTYgMzAuMTAyNjM4OTUgLTAuMjUgMzQuMTI1IEMtMyAzNiAtMyAzNiAtNS41NjI1IDM2LjE4NzUgQy04Ljk4ODcyNDMxIDM0LjUxODMxMzggLTEwLjE2MzE4MTc4IDMyLjI4MDAzMjUzIC0xMiAyOSBDLTEzLjI5ODU2OTYyIDI1LjEwNDI5MTEzIC0xMy4yNjMyNDEzNiAyMS4zNzQ2OTYwOCAtMTMuMzEyNSAxNy4zMTI1IEMtMTMuMzQxNTAzOTEgMTYuNTM0NTUwNzggLTEzLjM3MDUwNzgxIDE1Ljc1NjYwMTU2IC0xMy40MDAzOTA2MiAxNC45NTUwNzgxMiBDLTEzLjQ2MjU5ODk4IDkuMjE3NTUzOTYgLTEyLjMxNDU3Nzg0IDQuNzU2ODI3ODkgLTkgMCBDLTUuNzQ0ODkxOTcgLTEuNjI3NTU0MDIgLTMuNDM4MjEwNDkgLTAuOTA0NzkyMjMgMCAwIFogIiBmaWxsPSIjRjRGOEZBIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5NSw0NSkiLz4KPHBhdGggZD0iTTAgMCBDMy4wNjI1IDAuNSAzLjA2MjUgMC41IDUuMzc1IDIuNDM3NSBDNy41NDE0NDIzNiA2LjM2OTE5MTY4IDguMTA4NzIxNTEgMTAuMDI
1NzU3NzUgOC4wNjI1IDE0LjUgQzcuMDYyNSAxNS41IDcuMDYyNSAxNS41IDQuNSAxNS41NjI1IEMzLjY5NTYyNSAxNS41NDE4NzUgMi44OTEyNSAxNS41MjEyNSAyLjA2MjUgMTUuNSBDMS43MzI1IDEzLjUyIDEuNDAyNSAxMS41NCAxLjA2MjUgOS41IEMwLjQwMjUgOS41IC0wLjI1NzUgOS41IC0wLjkzNzUgOS41IEMtMi4wNjMzOTQ5MSAxMi44Nzc2ODQ3NCAtMi4wNzA0NDI3NSAxNS41MDgxMjA3MiAtMi4wNjI1IDE5LjA2MjUgQy0yLjA2NTA3ODEzIDIwLjIxODc4OTA2IC0yLjA2NzY1NjI1IDIxLjM3NTA3ODEzIC0yLjA3MDMxMjUgMjIuNTY2NDA2MjUgQy0yLjEzOTUyNjE2IDI1LjQzNDUzNDM4IC0yLjEzOTUyNjE2IDI1LjQzNDUzNDM4IC0wLjkzNzUgMjcuNSBDLTAuMjc3NSAyNy41IDAuMzgyNSAyNy41IDEuMDYyNSAyNy41IEMxLjcyMjUgMjYuMTggMi4zODI1IDI0Ljg2IDMuMDYyNSAyMy41IEM0LjcxMjUgMjMuNSA2LjM2MjUgMjMuNSA4LjA2MjUgMjMuNSBDNy43NjY4NzM2NCAyNy44NjA0ODg4MyA3LjUyNzczMTE3IDMwLjY3MjkyMjM2IDUuMzc1IDM0LjUgQzMuMDYyNSAzNi41IDMuMDYyNSAzNi41IDAuMDYyNSAzNy4xMjUgQy0yLjkzNzUgMzYuNSAtMi45Mzc1IDM2LjUgLTUuMTg3NSAzNC4zNzUgQy05Ljg0ODkxODA1IDI2LjcxNjk1NjA2IC0xMC4yODIxNTIwOSAxNy41ODc3NzQxOSAtOC4zNjcxODc1IDguOTE3OTY4NzUgQy02LjY5Nzg2Mjg0IDQuMTgyMzU4MjYgLTUuMDk0MDA3MTIgMC44NjcwNjUwNCAwIDAgWiAiIGZpbGw9IiNGM0Y3RkEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MS45Mzc1LDQzLjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzguMjUgMCA4LjI1IDAgMTIgMyBDMTQuNTcxODk2NzkgNi40MjkxOTU3MiAxNC41MDIxNDIgOS44MzkzOTQ4NiAxNCAxNCBDMTIuMjE1MjM3NTkgMTYuOTcyMzkyNDEgMTAuMTQ3OTE5NDUgMTkuNDI2MDQwMjcgNyAyMSBDNC42OSAyMSAyLjM4IDIxIDAgMjEgQzAgMTQuMDcgMCA3LjE0IDAgMCBaICIgZmlsbD0iI0UyMDcwNyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTEzLDE2MikiLz4K
PHBhdGggZD0iTTAgMCBDMC45OSAwIDEuOTggMCAzIDAgQzEuNjkyMTAwNjkgNy40Njg3OTM0NCAtMC4yNzMwNDI3NiAxNC42NjI5NDE0OSAtMi40MDI4MzIwMyAyMS45MzQ1NzAzMSBDLTMuNTUwOTU4NTMgMjUuOTA1NjA0NzIgLTQuNjQ3NTEwNzYgMjkuODkxMTAzMDUgLTUuNzUgMzMuODc1IEMtNS45NzI3NjYxMSAzNC42Nzg3MzA0NyAtNi4xOTU1MzIyMyAzNS40ODI0NjA5NCAtNi40MjUwNDg4MyAzNi4zMTA1NDY4OCBDLTYuOTUwNTA2OTUgMzguMjA2ODk5ODYgLTcuNDc1MzI1MzMgNDAuMTAzNDMwMSAtOCA0MiBDLTkuOTggNDIuNDk1IC05Ljk4IDQyLjQ5NSAtMTIgNDMgQy04LjYyMTkwODggMjguNDg3NTQyNDIgLTQuMzAwNzgxNjQgMTQuMjYwODE1OTggMCAwIFogIiBmaWxsPSIjREJFN0VGIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMDksNDUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEMzLjY1NDk3MzU2IDMuMzA5OTQ3MTMgMy4xMDA4NDMzNSA2Ljk5MTIzIDMuMDYyNSAxMC42MjUgQzMuMDU3OTg4MjggMTEuNDI2Nzk2ODggMy4wNTM0NzY1NiAxMi4yMjg1OTM3NSAzLjA0ODgyODEyIDEzLjA1NDY4NzUgQzMuMDM3MDMxNjggMTUuMDM2NDkwMDYgMy4wMTkwOTYwNSAxNy4wMTgyNTQzMyAzIDE5IEMxLjY4IDE5LjMzIDAuMzYgMTkuNjYgLTEgMjAgQy0yLjE2MzQ4ODY4IDE2LjUwOTUzMzk1IC0yLjE2ODM0Nzc2IDEzLjY3NzIyOTgzIC0yLjE4NzUgMTAgQy0yLjIwMTY3OTY5IDguNzYyNSAtMi4yMTU4NTkzOCA3LjUyNSAtMi4yMzA0Njg3NSA2LjI1IEMtMiAzIC0yIDMgMCAwIFogIiBmaWxsPSIjMEQ2ODlFIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNDIsNTIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuOTkgMC42NiAxLjk4IDEuMzIgMyAyIEMzLjI1MDExNTE4IDQuNTY5NjM1NzUgMy4zMjcwOTU5NCA2Ljg3NjQ2OTI3IDMuMjUgOS40Mzc1IEMzLjI0NDg0Mzc1IDEwLjExODc2OTUzIDMuMjM5Njg3NSAxMC44MDAwMzkwNiAzLjIzNDM3NSAxMS41MDE5NTMxMiBDMy4xODYwNTAyNCAxNC41ODU2NzY4NCAyLjk4MTAzMTE5IDE3LjA1NjkwNjQyIDIgMjAgQzEuMDEgMjAgMC4wMiAyMCAtMSAyMCBDLTIuNTc5Nzc3MDggMTYuODQwNDQ1ODMgLTIuMTg0NDcwODQgMTMuNDY1MzYxODMgLTIuMTg3NSAxMCBDLTIuMTk5NzQ2MDkgOS4yNjI2NTYyNSAtMi4yMTE5OTIxOSA4LjUyNTMxMjUgLTIuMjI0NjA5MzggNy43NjU2MjUgQy0yLjIyOTg3Mzk1IDUuODQyMjk5NDIgLTIuMTIyMDM0NDcgMy45MTk0NTczNyAtMiAyIEMtMS4zNCAxLjM0IC0wLjY4IDAuNjggMCAwIFogIiBmaWxsPSIjMDk2NjlEIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3MSw1MikiLz4KPHBhdGggZD0iTTAgMCBDNCAxIDQgMSA1IDIgQzUuMTI2MDIwNTQgNC4xMDEzMTkyMSA1LjE3NTc5MjIgNi4yMDc0Mzc4OCA1LjE4NzUgOC4zMTI1IEM1LjI
wMTY3OTY5IDkuNDYzNjMyODEgNS4yMTU4NTkzOCAxMC42MTQ3NjU2MyA1LjIzMDQ2ODc1IDExLjgwMDc4MTI1IEM1LjAxMjY3MDA2IDE0LjgyNDEyMjM3IDQuNTgzMTgxMSAxNi40NjU2NTg3MSAzIDE5IEMyLjAxIDE5IDEuMDIgMTkgMCAxOSBDMCAxMi43MyAwIDYuNDYgMCAwIFogIiBmaWxsPSIjMzQ3Q0FBIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0OSw1MykiLz4KPHBhdGggZD0iTTAgMCBDNi4wNTQ2ODc1IC0wLjE5NTMxMjUgNi4wNTQ2ODc1IC0wLjE5NTMxMjUgOCAwIEMxMCAyIDEwIDIgMTAuMjUgNC41IEMxMCA3IDEwIDcgOCA5IEM1LjMxMTYwNjE1IDkuMjY5OTE5MDYgMi43MDg1ODA2NCA5LjA4NzM3MzU3IDAgOSBDMCA2LjAzIDAgMy4wNiAwIDAgWiAiIGZpbGw9IiNFMjA4MDgiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDc5LDE2MikiLz4KPHBhdGggZD0iTTAgMCBDMS4zMiAwLjMzIDIuNjQgMC42NiA0IDEgQzUuNzc5MDk4MTUgNi4zMzcyOTQ0NiA1Ljg5OTg5MzgxIDExLjk1NDc4NjggMy42MjUgMTcuMTI1IEMzLjA4ODc1IDE3Ljc0Mzc1IDIuNTUyNSAxOC4zNjI1IDIgMTkgQzEuMzQgMTkgMC42OCAxOSAwIDE5IEMwIDEyLjczIDAgNi40NiAwIDAgWiAiIGZpbGw9IiMxNTZCQTAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEyMSw1MykiLz4KPHBhdGggZD0iTTAgMCBDMC45OSAwIDEuOTggMCAzIDAgQzEuODM3OTUwMDcgNi41NDg0OTMxMyAwLjI2NjE2NjE1IDEyLjc0NTM4MTQ0IC0yIDE5IEMtMi42NiAxOSAtMy4zMiAxOSAtNCAxOSBDLTMuNDYwNDg5MzQgMTIuMzEwMDY3ODEgLTIuMTEyOTM4MjkgNi4zNjUzOTI3MiAwIDAgWiAiIGZpbGw9IiNFM0VERjMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwOSw0NSkiLz4KPHBhdGggZD0iTTAgMCBDMC4zMyAwIDAuNjYgMCAxIDAgQzEuMDU0MDIyNzQgMi4xMDM4ODU2OSAxLjA5MjgwMjU2IDQuMjA4MTY3MTQgMS4xMjUgNi4zMTI1IEMxLjE0ODIwMzEzIDcuNDg0MjU3ODEgMS4xNzE0MDYyNSA4LjY1NjAxNTYzIDEuMTk1MzEyNSA5Ljg2MzI4MTI1IEMxIDEzIDEgMTMgLTEgMTYgQy0yLjA0OTc2OTY0IDEyLjg1MDY5MTA3IC0yLjEwMTMxNTk1IDEwLjYxMTg1NTQ0IC0yLjA2MjUgNy4zMTI1IEMtMi4wNTM0NzY1NiA2LjMxODYzMjgxIC0yLjA0NDQ1MzEyIDUuMzI0NzY1NjIgLTIuMDM1MTU2MjUgNC4zMDA3ODEyNSBDLTIuMDIzNTU0NjkgMy41NDE1MjM0NCAtMi4wMTE5NTMxMiAyLjc4MjI2NTYzIC0yIDIgQy0xLjM0IDIgLTAuNjggMiAwIDIgQzAgMS4zNCAwIDAuNjggMCAwIFogIiBmaWxsPSIjMEE2ODlFIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1Myw1NSkiLz4KPHBhdGggZD0iTTAgMCBDMS4yNTU0MTU1NyAzLjc2NjI0NjcxIDAuMzcwNjE5NTggNS4zNzE4ODkzNCAtMSA5IEMtMS42NiA5IC0yLjMyIDkgLTMgOSBDLTIuMjUgMi4yNSAtMi4yNSAyLjI1IDAgMCBaICIgZmlsbD0iI0YyRjZGOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTA4LDU1KSIvPgo8cGF0aCBkPSJNMCAwIEMyLjMxIDAgNC42MiAwIDcgMCBDNyAwLjMzIDcgMC42NiA3IDEgQzUuMDIgMSAzLjA0IDEgMSAxIEMxLjMzIDIuMzIgMS42NiAzLjY0IDIgNSBDMS4wMSA1LjY2IDAuMDIgNi4zMiAtMSA3IEMtMC42NyA0LjY5IC0wLjM0IDIuMzggMCAwIFogIiBmaWxsPSIjM0Q4MUFEIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNzAsNDQpIi8+Cjwvc3ZnPgo=` as any,
        group: ['transform'],
        version: 1,
        description: 'ConvertToPdf',
        defaults: {
            name: 'ConvertToPdf',
        },
        inputs: ['main'],
        outputs: ['main'],
        properties: [],
    };

    async execute(this: IExecuteFunctions): Promise<INodeExecutionData[][]> {
        // PRIVATE METHODS

        let execAsync = promisify(exec);

        let convertDocxToPdf = async (data: Buffer, file: IBinaryData) => {
            let importedPath = './imported';
            const importedFilePath = path.join(importedPath, file.fileName!);
            await fs.mkdir(importedPath, { recursive: true });
            await fs.writeFile(importedFilePath, data);
            var result = await executeConvertCommand(importedFilePath, file);
            await fs.unlink(importedFilePath);
            return result;
        };

        let executeConvertCommand = async (importedPath: string, file: IBinaryData): Promise<Buffer> => {
            const outputPath = "./converted";
            const outputFilePath = path.join(outputPath, path.basename(importedPath, file.fileExtension) + "pdf");
            const command = `soffice --headless --convert-to pdf --outdir "${outputPath}" "${importedPath}"`;
            await fs.mkdir(outputPath, { recursive: true });
            await execAsync(command);
            var outputFile = fs.readFile(outputFilePath);
            await fs.unlink(outputFilePath);
            return outputFile;
        }

        // EXECUTE

        const items = this.getInputData();
        const returnData: INodeExecutionData[] = [];

        for (let i = 0; i < items.length; i++) {
            const item = items[i];
            if (item.binary) {
                const binaryData = item.binary['file'];
                if (binaryData) {
                    const buffer = Buffer.from(binaryData.data, 'base64');
                    let convertedFile = await convertDocxToPdf(buffer, binaryData);
                    const returnItem = {
                        json: {},
                        binary: {
                            data: await this.helpers.prepareBinaryData(convertedFile, binaryData.fileName?.replace(/\.[^.]+$/, '.pdf')),
                        },
                    };
                    returnData.push(returnItem);
                }
            }
        }
        return [returnData];
    }
}